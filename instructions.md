### Добро пожаловать в документации о написании исполняемых инструкций AI-M



## Введение

AI-M Ассистент - это пара исполняемых инструкций:
Исполняемая инструкция предстовляет из себя текст который может содержать js-выражения и модификаторы выполняемые в разные этапы жизненого цикла инструкции, которые могут выполнять полезную работу а так же изменять саму инструкцию.

В этом документе мы разберем, как использовать новые функции и какие модификаторы доступны.

---

**Использование JavaScript-выражений**

Вы можете вставлять JavaScript-выражения прямо в текст инструкции. Например:

```
{{2+2}}  ->   '4'
```

Эти выражения будут автоматически вычислены, а их результат будет подставлен вместо выражения.

---

**Жизненный цикл запроса**

Запрос сначала проходит `prev` инструкцию, а затем `exec`. Разница между ними в том,  что `prev` сначала изменяется под действием js-выражений и модификаторов, а затем полученый результат используется для получения конечного ответа*, а `exec` после того же процесса нигде не используется, а так же в контексте выполнения добовляется переменная 'answer' - конечный ответ пользователю.
\* Только в том случае если полученый результат не является пустой строкой.

Инструкция проходит через следующие этапы:

1. **Получение исходного текста инструкции**: Исходный текст инструкции берется для последующей обработки.

2. **Выделение фрагментов с выражениями и модификаторами**: Из исходного текста инструкции выделяются все фрагменты, содержащие выражения и модификаторы.

3. **Рекурсивное выполнение фрагментов**: Выделенные фрагменты с выражениями и модификаторами выполняются рекурсивно от наиболее вложенных. Например:
   ```
   {{useGpt3('у какого домашнего животного {{5+5+6+6}} пальцев?')}}
   ```
   Будет выполнено следующим образом:
   ```
   {{useGpt3('у какого домашнего животного 12 пальцев?')}}
   ```
   Результат:
   ```
   'кошка'
   ```

4. **Использование модификаторов**: Модификаторы могут использовать API, память и модели GPT для своей работы.

5. **Получение основного ответа**: После выполнения всех фрагментов инструкции полученная инструкция используется снова с помощью модели GPT для получения основного ответа.


Этот процесс позволяет создавать более сложные и гибкие инструкции, которые могут включать в себя вычисления, обращения к памяти и внешние API.

---
**Рекурсивное использование блоков**

JavaScript-выражения и модификаторы могут использоваться рекурсивно, что позволяет создавать более сложные и гибкие инструкции.

---

## Список модификаторов

Список модификаторов с описанием и примерами использования:

---

1. ### useGpt4
 - **Синтаксис**: `useGpt4({prompt})`
 - **Описание**: Выполняет запрос к модели GPT-4 для получения ответа на заданный вопрос.
 -  **Параметры**:  
			 ```
			    {
				    prompt: 'Указания к модели',
				    cond?: 'Условие выполнения',
				    condjs?: 'Функция js должна возвращать boolean',
				    ctx?: 'Имя, если передано то результат не вставляется в инструкцию а запоминается в контекст под этим именем',
			    }
		    ```
 - **Пример использования**: 
     ```
     {{useGpt4({prompt: 'как называется птица с синей грудкой'})}}
     ```
 - **Результат**: 
     ```
     'синица'
     ```
---
2. ### useGpt3
    
  -   **Синтаксис**: `useGpt3({prompt})`
  -   **Описание**: Выполняет запрос к модели GPT-3.5 для получения ответа на заданный вопрос .
  -   **Параметры**: 
	    ```
	    {
		    prompt: 'Указания к модели',
		    cond?: 'Условие выполнения',
		    condjs?: 'Функция js должна возвращать boolean',
		    ctx?: 'Имя, если передано то результат не вставляется в инструкцию а запоминается в контекст под этим именем',
	    }
	    ```
    
 - **Пример использования**:
        
        
        `{{useGpt3({prompt: 'Объясни принцип работы блокчейна'})}}` 
        
  -   **Результат**:
        
        `'Блокчейн — это децентрализованная технология, на которой базируются криптовалюты, позволяющая безопасно и прозрачно хранить данные.'`
---
3. ###  **useText**
    
  -   **Синтаксис**: `useText({text})`
  -   **Описание**: Возвращает заданный текст без изменений. Используется для вывода текста напрямую, минуя вызов моделей.
  -   **Параметры**:    
	    ```
	    {
	       text: 'Текст, который нужно вернуть',
	       cond?: 'Условие выполнения',
	       condjs?: 'Функция js должна возвращать boolean',
	       ctx?: 'Имя, если передано, то текст сохраняется в контекст под этим именем',
	    }
	    ```
    
  -   **Пример использования**:
        
        `{{useText({text: 'Привет, мир!'})}}` 
        
  -   **Результат**:
        
        `'Привет, мир!'`
---
4. ### **useScript**

-   **Синтаксис**: `useScript({script})`
-   **Описание**: Выполняет выполнение JavaScript-кода в контексте переданных данных. Функция позволяет динамически выполнять пользовательские скрипты и возвращать их результат.
-   **Параметры**:
	```
	{
	   script: 'JavaScript-код, который будет выполнен',
	   cond?: 'Условие выполнения',
	   condjs?: 'Функция js должна возвращать boolean',
	   ctx?: 'Имя, если передано, то результат сохраняется в контекст под этим именем',
	}
	``` 

-   **Пример использования**:
    `{{useScript({script: 'return prompt.length > 10 ? "Длинный текст" : "Короткий текст"'})}}` 
    
-   **Результат**:
    `'Короткий текст'`
---
5. ### useDelay
 - **Синтаксис**: `useDelay(useDelay({s}))`
 - **Описание**: Задерживает ответ на указанное количество милисекунд.
 -   **Параметры**:
		```
		{
		   s: 'Количество секунд для задержки',
		   cond?: 'Условие выполнения',
		   condjs?: 'Функция js должна возвращать boolean',
		}
		``` 

-   **Пример использования**:
    `{{useDelay({s: 5000})}}`
 - **Результат**: 
     Ответ будет задержан на 5 секунд. В инструкции заменяется на пустую строку.
---
6. ### addMess
    
  -   **Синтаксис**: `addMess({text, wait})`
  -   **Описание**: Добавляет сообщение с возможной задержкой перед его отображением. Используется для отправки сообщений пользователям с указанием времени задержки.
  -   **Параметры**:
	    ```
	    {
	       text: 'Текст сообщения, который будет отправлен',
	       wait?: 'Задержка перед отображением сообщения (в секундах). По умолчанию — 0',
	       cond?: 'Условие выполнения',
	       condjs?: 'Функция js должна возвращать boolean',
	    }
	    ``` 
  -   **Пример использования**:
        `{{addMess({text: 'Сообщение будет отображено через 3 секунды', wait: 3})}}` 
        
  -   **Результат**:
        `Сообщение отправлено с задержкой 3 секунды.`
---
7. ### addWelcome

-   **Синтаксис**: `addWelcome({text})`
-   **Описание**: Отправляет приветственное сообщение, если это первое сообщение пользователя. Используется для автоматической отправки приветствия при первом взаимодействии.
-   **Параметры**:
	```
	{
	   text: 'Текст приветственного сообщения',
	   cond?: 'Условие выполнения',
	   condjs?: 'Функция js должна возвращать boolean',
	}
	``` 

-   **Пример использования**:
    `{{addWelcome({text: 'Добро пожаловать в наш сервис!'})}}` 
    
-   **Результат**:
    `Приветственное сообщение отправлено: "Добро пожаловать в наш сервис!"` 
    
-   **Примечание**: Сообщение отправляется только в случае, если это первое сообщение пользователя (`isFirstMessage: true`).

---
8. ### memorize
  -   **Синтаксис**: `memorize({key, data, expire})`
  -   **Описание**: Сохраняет данные в базе данных под заданным ключом с указанным сроком действия. Данные будут доступны для использования в разных диалогах и пользователями.
  -   **Параметры**:
        ```
        {
           key: 'Ключ для сохранения данных',
           data: 'Данные, которые нужно сохранить',
           expire?: 'Срок действия в секундах, по умолчанию — 45 дней (45*24*60*60)',
           cond?: 'Условие выполнения',
           condjs?: 'Функция js должна возвращать boolean',
        }
        ``` 
        
  -   **Пример использования**:
        `{{memorize({key: 'globalInfo', data: 'Информация для всех пользователей', expire: 86400})}}` 
        
  -   **Результат**:
        `Данные сохранены с ключом "globalInfo" на 1 день.`
---
9. ### useMemory

-   **Синтаксис**: `useMemory({key})`
    
-   **Описание**: Извлекает данные из базы по заданному ключу. Возвращает все данные, соответствующие ключу, которые ещё не истекли.
    
-   **Параметры**:
    ```
    {
       key: 'Ключ для поиска данных',
       cond?: 'Условие выполнения',
       condjs?: 'Функция js должна возвращать boolean',
       ctx?: 'Имя, если передано, то результат сохраняется в контекст под этим именем',
    }
    ``` 
    
-   **Пример использования**:
    `{{useMemory({key: 'globalInfo'})}}` 
    
-   **Результат**:
    `'Информация для всех пользователей'` 
    
-   **Примечание**: Если данных по ключу несколько, они будут объединены и возвращены как один результат, разделённый новой строкой.
---
10. ### setSession
  -   **Синтаксис**: `setSession({data, expire})`
        
  -   **Описание**: Обновляет или создаёт данные сессии для указанного клиента. Данные сессии хранятся с указанным сроком действия и могут быть объединены с существующими данными.
        
  -   **Параметры**:
        ```
        {
           data: 'Данные сессии, которые нужно сохранить или обновить',
           expire?: 'Срок действия в секундах, по умолчанию — 45 дней (45*24*60*60)',
           cond?: 'Условие выполнения',
           condjs?: 'Функция js должна возвращать boolean',
        }
        ``` 
        
  -   **Пример использования**:
        `{{setSession({data: {lastVisitedPage: '/home'}, expire: 3600})}}` 
        
  -   **Результат**:
        `Данные сессии обновлены или созданы с сроком действия 1 час.` 
        
  -   **Примечание**: Функция объединяет новые данные с уже существующими для данного клиента и обновляет срок действия.
        
---
11. ### useSession

-   **Синтаксис**: `useSession({param})`
-   **Описание**: Извлекает данные сессии **в контекст**. Можно получить либо весь набор данных, либо конкретное значение по ключу, если указан параметр.
-   **Параметры**:
    ```
    {
       param?: 'Ключ, по которому нужно получить значение из данных сессии. Если не указан, возвращаются все данные сессии',
       cond?: 'Условие выполнения',
       condjs?: 'Функция js должна возвращать boolean',
    }
    ``` 
    
-   **Пример использования**:
    `{{useSession({param: 'lastVisitedPage'})}}` 
    
-   **Результат**:
    `'/home'` 
    
-   **Примечание**: Если параметр не указан, возвращаются все данные сессии в контекст по их ключами. Если параметр указан и данные сессии содержат соответствующее значение, это значение будет возвращено.
---
12. ### useTeam
  -   **Синтаксис**: `useTeam({trigger, dialog})`
  -   **Описание**: Делает запрос к другому ассистенту или системе. Можно передать диалог как массив строк, где последнее сообщение от пользователя, или оставить пустым, чтобы использовать текущий диалог.
  -   **Параметры**:
        ```
        {
           trigger: 'Команда или действие для запроса к другому ассистенту',
           dialog?: 'Диалог в виде массива строк',
           cond?: 'Условие выполнения',
           condjs?: 'Функция js должна возвращать boolean',
           ctx?: 'Имя, если передано, то результат сохраняется в контекст под этим именем',
        }
        ``` 
        
  -   **Пример использования**:
        
        `{{useTeam({trigger: 'startProject', dialog: ['мы будем говорить о контенте', 'давай говорить только про копирайтинг']})}}` 
        
  -   **Результат**:
        
        `В текущем диалоге заменяется на ответ от ассистента, связанного с переданным триггером.`
---
13. ### waitMess
  -   **Синтаксис**: `waitMess({s})`
  -   **Описание**: В отличие от `useDelay`, функция `waitMess` создает задержку для объединения нескольких сообщений поступивших в заданное время в одно,  чтобы создать единый ответ.
  -   **Параметры**:
        ```
        {
           s: 'Колличество миллисекунд для задержки',
           cond?: 'Условие выполнения',
           condjs?: 'Функция js должна возвращать boolean',
        }
        ``` 
        
  -   **Пример использования**:
        
        `{{waitMess({s: 8000})}}` 
        
  -   **Результат**:
        
        `Будет отправлен единый ответ на все сообщения, поступившие в течение 8 секунд`
	`Внимание отправленые за это время сообщения, не суммируются и не воспринимаются системой как одно последние сообщение`
---
14. ### usePhoto

-   **Синтаксис**: `usePhoto({prompt, count, size})`
    
-   **Описание**: Выполняет поиск изображений по заданному запросу на фотостоке и возвращает ссылки на найденные фотографии. Поддерживает указание количества изображений и их размер.
    
-   **Параметры**:
    ```
    {
       prompt: 'Запрос для поиска изображений',
       count?: 'Количество изображений, которое нужно вернуть (по умолчанию 1)',
       size?: 'Размер изображений в формате "ширинаxвысота" (по умолчанию "512x512")',
       cond?: 'Условие выполнения',
       condjs?: 'Функция js должна возвращать boolean',
       ctx?: 'Имя, если передано, то результат сохраняется в контекст под этим именем',
    }
    ``` 
    
-   **Пример использования**:
    `{{usePhoto({prompt: 'собака', count: 3, size: '800x600'})}}` 
    
-   **Результат**:
    `'https://example.com/photo1.jpg\nhttps://example.com/photo2.jpg\nhttps://example.com/photo3.jpg'` 
    
-   **Примечание**: Функция выполняет запрос к API фотостока и возвращает ссылки на изображения, соответствующие запросу. Если количество изображений больше доступного, будет возвращено максимальное доступное количество.
---
15. ### useVideo

-   **Синтаксис**: `useVideo({prompt, count, size})`
    
-   **Описание**: Выполняет поиск видеороликов по заданному запросу на видеостоке и возвращает ссылки на найденные видео. Поддерживает указание количества видео и их размера.
    
-   **Параметры**:
    ```
    {
       prompt: 'Запрос для поиска видео',
       count?: 'Количество видео, которое нужно вернуть (по умолчанию 1)',
       size?: 'Размер видео в формате "ширинаxвысота" (по умолчанию "512x512")',
       cond?: 'Условие выполнения',
       condjs?: 'Функция js должна возвращать boolean',
       ctx?: 'Имя, если передано, то результат сохраняется в контекст под этим именем',
    }
    ``` 
    
-   **Пример использования**:
    `{{useVideo({prompt: 'собака', count: 3, size: '1280x720'})}}` 
    
-   **Результат**:
    `'https://example.com/video1.mp4\nhttps://example.com/video2.mp4\nhttps://example.com/video3.mp4'` 
    
-   **Примечание**: Функция выполняет запрос к API видеостока и возвращает ссылки на видео, соответствующие запросу. Если количество видео больше доступного, будет возвращено максимальное доступное количество.
---
16. ### useDalle

-   **Синтаксис**: `useDalle({prompt})`
    
-   **Описание**: Генерирует изображения по заданному запросу с использованием модели DALL-E. Поддерживает указание количества изображений и их размера.
    
-   **Параметры**:
    ```
    {
       prompt: 'Запрос для генерации изображений',
       count?: 'Количество изображений, которое нужно создать (по умолчанию 1)',
       size?: 'Размер изображений в формате "ширинаxвысота" (по умолчанию "1024x1024")',
       cond?: 'Условие выполнения',
       condjs?: 'Функция js должна возвращать boolean',
       ctx?: 'Имя, если передано, то результат сохраняется в контекст под этим именем',
    }
    ``` 
    
-   **Пример использования**:
    `{{useDalle({prompt: 'собака в шляпе', count: 2, size: '512x512'})}}` 
    
-   **Результат**:
    `'https://example.com/image1.png\nhttps://example.com/image2.png'`
---
17. ### useMD2

-   **Синтаксис**: `useMD2({prompt})`
    
-   **Описание**: Генерирует изображения по заданному запросу с использованием модели DALL-E. Поддерживает указание количества изображений и их размера.
    
-   **Параметры**:
    ```
    {
       prompt: 'Запрос для генерации изображений',
       count?: 'Количество изображений, которое нужно создать (по умолчанию 1)',
       seed?: 'Семя для генерации',
       cond?: 'Условие выполнения',
       condjs?: 'Функция js должна возвращать boolean',
       ctx?: 'Имя, если передано, то результат сохраняется в контекст под этим именем',
    }
    ``` 
    
-   **Пример использования**:
    `{{useMD2({prompt: 'коты играют', count: 2})}}` 
    
-   **Результат**:
    `'[https://example.com/image1.png\nhttps://example.com/image2.png](https://image.pollinations.ai/prompt/коты%20играют%22?width=1024&height=1024&seed=251491254&nofeed=true&nologo=true&model=flux-realism
https://image.pollinations.ai/prompt/коты%20играют%22?width=1024&height=1024&seed=415339028&nofeed=true&nologo=true&model=flux-realism)'`
---
18. ### fetchApi

-   **Синтаксис**: `fetchApi({url, options})`
    
-   **Описание**: Выполняет HTTP-запрос к указанному API-адресу с заданными параметрами. Позволяет отправлять запросы с произвольными опциями.
    
-   **Параметры**:
    ```
    {
       url: 'Адрес API, к которому выполняется запрос',
       options?: 'Опции для HTTP-запроса (метод, заголовки и др.)',
       cond?: 'Условие выполнения',
       condjs?: 'Функция js должна возвращать boolean',
    }
    ``` 
    
-   **Пример использования**:
    ```
    {{fetchApi({
       url: 'https://api.example.com/data',
       options: {
           method: 'GET',
           headers: { 'Authorization': 'Bearer token' }
       }
    })}}
    ```
   - **Результат**: 
      Выполнит GET-запрос к URL 'https://api.example.com/data'. В инструкции заменяется на пустую строку.
---
19. ### fetchPage

-   **Синтаксис**: `fetchPage({url, options})`
    
-   **Описание**: Выполняет HTTP-запрос к указанному URL и возвращает текстовое содержимое страницы. HTML-код страницы преобразуется в текст для удобного использования.
    
-   **Параметры**:
    ```
    {
       url: 'Адрес страницы для запроса',
       options?: 'Опции для HTTP-запроса (метод, заголовки и др.)',
       cond?: 'Условие выполнения',
       condjs?: 'Функция js должна возвращать boolean',
       ctx?: 'Имя, если передано, то результат сохраняется в контекст под этим именем',
    }
    ``` 
    
-   **Пример использования**:
    ```
    {{fetchPage({
       url: 'https://example.com',
       options: {
           method: 'GET',
           headers: { 'User-Agent': 'MyApp' }
       }
    })}}
    ``` 
    
-   **Результат**:
    `'Текстовое содержимое страницы после преобразования из HTML'`
---
20. ### fetchJSON

-   **Синтаксис**: `fetchJSON({url, options})`
    
-   **Описание**: Выполняет HTTP-запрос к указанному URL и возвращает ответ в формате JSON. Ожидается, что сервер вернет данные в формате JSON.
    
-   **Параметры**:
    ```
    {
       url: 'Адрес API, к которому выполняется запрос',
       options?: 'Опции для HTTP-запроса (метод, заголовки и др.)',
       cond?: 'Условие выполнения',
       condjs?: 'Функция js должна возвращать boolean',
       ctx?: 'Имя, если передано, то результат сохраняется в контекст под этим именем',
    }
    ``` 
    
-   **Пример использования**:
    ```
    {{fetchJSON({
       url: 'https://api.example.com/data',
       options: {
           method: 'GET',
           headers: { 'Authorization': 'Bearer token' }
       }
    })}}
    ``` 
    
-   **Результат**:
    `'{"ключ": "значение"}'  // JSON-ответ сервера в виде строки`
---
21. ### fetchText

-   **Синтаксис**: `fetchText({url, options})`
    
-   **Описание**: Выполняет HTTP-запрос к указанному URL и возвращает ответ в виде текста. Использует метод GET по умолчанию, но можно указать другие методы и параметры запроса.
    
-   **Параметры**:
    ```
    {
       url: 'Адрес API, к которому выполняется запрос',
       options?: {
           method?: 'Метод запроса (например, GET, POST)',
           headers?: 'Объект заголовков для запроса',
           body?: 'Тело запроса для методов, поддерживающих тело (например, POST)'
       },
       cond?: 'Условие выполнения',
       condjs?: 'Функция js должна возвращать boolean',
       ctx?: 'Имя, если передано, то результат сохраняется в контекст под этим именем'
    }
    ``` 
    
-   **Пример использования**:
    ```
    {{fetchText({
       url: 'https://www.example.com/page',
       options: {
           method: 'GET'
       }
    })}}
    ``` 
    
-   **Результат**:
    `'Текстовый ответ сервера'  // Ответ в виде строки`
---
22. ### useKeyManager

-   **Синтаксис**: `useKeyManager({masterKey='getKey', diaposone=30, text="Access is denied, take the key. If the key doesn't work, get a new one"})`
    
-   **Описание**: Если в диалоге присутствует сообщение вида `'getKey user_Tag'`, то функция возвращает ключ, действительный для пользователя с тегом `user_Tag`. Этот ключ будет действителен в течение указанного диапазона дней (`diaposone`), начиная с 1 января 1970 года. Если пользователь не предоставил правильный ключ, он получит сообщение с текстом из параметра `text`, указывающее на необходимость получения нового ключа. Проверка ключа осуществляется регулярно.
    
-   **Параметры**:
    ```
    {
      masterKey: 'Ключ, который используется для создания новых пользовательских ключей (по умолчанию "getKey")',
      diaposone: 'Период времени в днях, в течение которого ключ действителен (по умолчанию 30 дней)',
      text: 'Сообщение, которое будет отправлено пользователю, если ключ недействителен или отсутствует (по умолчанию "Access is denied, take the key. If the key doesn\'t work, get a new one")'
    }
    ``` 
    
-   **Пример использования**:
    `{{useKeyManager('MyKeyToCreateUsersKeys', 30, text="Access is denied.")}}` 
    
-   **Результат**:
    -   Пустая строка, если ключ действителен.
    -   Сообщение с текстом `text`, если ключ недействителен или отсутствует, с блокировкой основного ответа.
-   **Примечание**:
    -   Генерируемый ключ является хешем, который создается на основе комбинации тега пользователя и возраста ключа.
    -   Ключи проверяются на предмет их действительности в зависимости от времени и диапазона действия.
---
23. ### useFunction

-   **Синтаксис**: `useFunction({func, cond, params})`
    
-   **Описание**: Выполняет указанную функцию `func` в зависимости от выполнения условия. Условие может быть задано как JavaScript-функция `condJs`, возвращающая логическое значение, или в виде строки `cond`, указывающей условие для проверки. Параметры для функции задаются через `params`, где указывается ключ и описание параметра, которые модель использует для генерации значений. Результат выполнения функции может быть вставлен в инструкцию или записан в контекст, если указан `ctx`.
    
-   **Параметры**:
    ```
    {
      func: "Функция, которую нужно выполнить (должна быть функцией)",
      cond?: "Условие в виде строки, которое будет проверено (опционально)",
      condJs?: "JavaScript-функция, возвращающая логическое значение (опционально)",
      params: "Описание параметров в js обьекте, где ключи - это имена параметров, а значения - их описание",
      ctx?: "Ключ, указывающий на контекст, куда будет записан результат выполнения функции (опционально)"
    }
    ``` 
    
-   **Логика**:
    
    1.  **Проверка условия**:
        -   Если задан `condJs`, функция проверяет его выполнение. Если `condJs` возвращает `false`, функция завершает работу и возвращает пустой результат.
        -   Если задан `cond`, функция отправляет запрос к модели  для проверки условия. Если условие выполняется, продолжается выполнение функции.
    2.  **Определение параметров**:
        -   Если `params` предоставлены, модель использует их описание для генерации значений, которые будут переданы функции `func`. Параметры должны быть переданы в виде объекта, где ключи соответствуют параметрам функции, а значения определены моделью.
    3.  **Выполнение функции**:
        -   Функция `func` вызывается с переданными параметрами. 
    4.  **Обработка ответа**:
        -   Если `ctx` не указан, результат выполнения функции вставляется в инструкцию.
-   **Пример использования**:
    ```
    {{useFunction({
      func: ({param1, param2}) => myFunction,
      cond: "some condition",
      params: '{"param1": "description1", "param2": "description2"}',
      ctx: "responseContext"
    })}}
    ``` 
    
-   **Результат**: 
Результат выполнения функции `func` в зависимости от условий либо вставляется в инструкцию, либо записывается в указанный контекст, если `ctx` задан.

	
		
---
24. ### setModel

- Синтаксис: `setModel({settings, extra})`
- Описание: Функция setModel устанавливает настройки для модели. 

- Параметры:
```
  {
     settings: 'Объект с настройками модели (например, temperature, top_p и т.д.)',
     extra?: 'Дополнительные настройки, которые можно применить к модели',
     ...args: 'Дополнительные аргументы для проверки условий',
  }
  ```

- Пример использования: `{{setModel({settings: {temperature: 0.8} })}}`

- Результат: Изменяются настройки модели.
---

	
		
---
25. ### useProcess

- Синтаксис: `useProcess(fn, timeout, count=500)`
- Описание: Функция useProcess используется как альтернатива setInterval однако обладает некоторыми особенностями, а именно: в случае перезапуска сервера процесс востановиться, так-же в момент использования функция не замыкается на внешние параметры, а только на контекст который доступен в самой инструкции (описан ниже). 

- Параметры (обратите внимание что передаются через запятую в одной строке без фигурных скобок):
```
  fn (непосредствено функция процесса), timeout (с какой переодичностью выполняется функция), count=500 (сколько раз выполнять, по умолчанию - 500)
  ```

- Пример использования: `useProcess(()={handler()}, 5*60*1000, 1)`

- Результат: функция `handler()` выполнится через 5 минут.
---






**Эти модификаторы предоставляют различные возможности для выполнения HTTP-запросов, обработки контента и взаимодействия с веб-ресурсами.**

---


### Контекст исполнения

Помимо модификаторов, вашему скрипту доступен контекст исполнения, который включает в себя следующие элементы:

  - `clientName`: Строка, представляющая имя клиента.
  - `clientId`: Строка, представляющая идентификатор клиента.
  - `webClient`: Строка, может содержать: 'telegram', 'whatsapp', 'plugin', 'web' или другие значения.
  - (другие поля метаданных, если они присутствуют).
  - `dialog`: Массив сообщений.
- `isFirstMessage`: Булево значение, указывающее, является ли текущее сообщение первым в диалоге.
- `prompt`: Непосредственно исходный текст исполняемой инструкции.
- `answer`: Вначале это пустая строка, а к моменту выполнения `exec`  содержит полученый ответ.

Контекст предоставляет доступ к широкому набору переменных и методов JavaScript, которые могут быть использованы для выполнения различных задач. Дополнительную информацию о JavaScript можно найти в [документации MDN (Mozilla Developer Network)](https://developer.mozilla.org/en-US/docs/Web/JavaScript).
 - `Date`: Объект, представляющий текущее время. [mdn](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date)
  - `Math`: Объект, предоставляющий математические функции и константы. [mdn](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math)
  - (другие переменные и методы, доступные в среде выполнения JavaScript) [mdn](https://developer.mozilla.org/en-US/docs/Web/JavaScript)

**Контекст так же расширяется ключами передаными в `ctx` параметрами в рамках 1 запроса. Будьте внимательны `ctx` ключи не должны совпадать с указаными выше!** 


## Example
Давайте создадим асистента вместе и рассмотрим разные кейсы использования.

> Мы будем сосдавать  `асистента продавца`  для автоворонок блогера-эксперта, однако нам бы не хотелось что бы этот пример ограничивал вашу фантазию на приедмет использования этого инструмента, поэтому в конце мы коротко перечислим кейсы которые удалось создать нашей команде.

-   Предположим наш эксперт продает консультации для самозанятых и обещает после занятий что клиент научиться освобождать свое время не теряя в доходе.
-   У эксперта есть "лид-магнит" - бесплатный чек лист по которому самозанятый сможет найти свои ошибки
-   Эксперт дает рекламу предлогая бесплатный чеклист, для этого необходимо написать в личные сообщения например в инстаграм.
-   Предположим эксперт ведет свою работу в google-sheets, умеет создавать опросы и открывать доступ к документам по ссылке. (В вашем случае это может быть CRM система, ваше приложение или вовсе ничего из этого)
-   **Цель**  `асистента продавца`  **отправить**  обещанный чеклист, а так же  **собрать информацию**  о клиенте и  **назначить онлайн встречу**


//будет дописанно позже

## Алея идей

[](https://github.com/AI-M-chats/docs/blob/main/instructions.md#%D0%B0%D0%BB%D0%B5%D1%8F-%D0%B8%D0%B4%D0%B5%D0%B9)

Нам бы не хотелось, что бы этот пример ограничивал вашу фантазию на приедмет использования этого инструмента, поэтому мы коротко перечислим кейсы которые удалось создать нашей команде.

-   Самое очевидное, Ассистент который сначала отдает лид-магнит (закрытое видео автора), потом продает инфо-программу + ведение ментора, через 2 месяца ассистент возвращался с вопросом о том купил ли лид программу, на сколько она понравилась и мягко закрывает либо на продажу програмы либо (если програма пройдена и все понравилось) вип-консультацию с основателем.
    
-   Date planer. Один из наших сотрудников в этапе ухаживаний, поэтому на этапе тестирования, он сделал ассистента который смотрит афишу, погоду, а так же рестораны поблизости к месту события и выдает 2-4 варианта как может пройти выходной. Теперь он всегда на готове и просто не отрозим.
    
-   Меннеджер аккаунтов. Хотя мы настаивали на том, что еще слишком рано, был создан ассистент, который получал данные с биржи, первую страницу новостных изданий и выдавал предположение о том куда двинется рынок. И второй ассистент, который можно поросить открыть сделку и он делает это для многих подключенных аккаунтов. Хотя мы не рекамендуем этот пример, примечательно что можно создавать ассистентов способных управлять большим колличеством аккаунтов.
    
-   Ассистент для поиска компании. Клиент отвечает на вопросы: каким спортом занимается, на какую площадку ходит, и ему даётся ссылка на аккаунт потенциального мэтча, а если такого не находиться то его запрос запоминается на 4 дня и он ждёт когда ему напишут.
    
-   Самопроверка сотрудников. Когда содрудник завершает задачу (например курьер), то он пишет ассистенту что он что то сделал или что почему то не сделал, ассистент используя дерево вопросов задает их сотруднику (например если что то сделать не удалось , уточнил ли причину, дату, оставил ли ключ и так далее). Сотрудник отвечая на эти вопрсы может лучше выполнить свою задачу, а так же если все супер, результат анкетирования записывается в crm, по сути фиксируя результат и ответственность за него за сотрудником
    
-   Выявление потребности. Дизайнер-планировщик работая на себя тратил уйму времени на одинаковые диалоги с клиентом что бы сформировать четкое ТЗ. На помощь пришел ассистент который принимал обращения клиентов, сразу задавал уточняющие вопросы, спрашивал что нестандартного нужно учесть и формировал правильно сформулированный запрос для дизайнера.
    
-   Школа. Целая группа простых ассистентов каждый из которых по сути дает клиенту маленькое задание, обьясняет как его нужно выполнять и просит выполнить. Далее задает проверяющие вопросы, до тех пор, пока не получиться правильный результат. Если результат не верный указывает на то, где именно ошибка, а если верный, то отправляет к следующему ассистенту. Так например команда ассистентов может научить Настраивать контекстную рекламу или делать анализ конкурентов, если разбить это действие на 5-9 супер маленьких шагов.
    
-   Новая жизнь чек-листам. Для примера мы взяли (найденный в интернете) чек-лист при покупке поддержаного авто марки vw на бензиновых турбированых моторах 2011-2019годов выпуска. В чек листе указывалась последовательность проверок и допроверок. (по сути упакован весь опыт автоподборщика). Этот чеклист нужно дополнить - например видео со звуками моторов. Документ получился обьемным, однако его можно упаковать в ассистенты. Теперь покупатель может приходить на осмотр авто с помощником в телефоне. Примечательно что чек-листы были очень популярны и можно найти много качестенных примеров: от авто до анализа бизнес структур, и если раньше для работы со сложными и обьемными чеклистами нужен был специалист, теперь клиенту нужен только ассистент.
    
-   'Рекрутер (массовый подбор)' - вакансия подразумевающая, что человек за небольшую оплату проводит первичный опрос кандидатов в соцсетях, в результате заполняет гугл-форму или форму crm. Делается это для того что бы отсеять лишних кандидатов, а подходящих ранжировать, с кем имеет смысл провести интервью сначала. Раньше это был манатонный труд, теперь достаточно пригласить кандидата написат в аккаунт с подключенным ассистентом, асистент сам проанкетирует, договориться о времени звонка если кондидат подходящий, а так же запишет результат в crm или таблицу.
    
-   Асистент помогающий сделать идиальный подарок для тех, у кого все есть. По сути ассистент задает вопросы, таким образом подбирая идиальный слоган а так же картинкуи тип мерча, после чего формируется реферальная ссылка к контрагенту где в конструкторе уже готовый вариант мерча.
    
-   AI-фрилансеры - копирайтеры, верстальщики, ux/ui дизайнеры и многие другие уже используют нейросети для ускорения своей работы. Казалось бы - зачем им ассистент, неужели в ассистент можно качественно упаковать всё разнобразие запросов? А что если ускориться еще - Асистент скурпулезно расспрашивает клиента, а в качестве результата формирует промпт для конкретного клиента.
    
-   Ассистент для генирации контента. Те кто вел свои соц-сети знает как не просто генерировать актуальный и уникальный контент, а ведь регулярность - залог успеха. А как обидно когда контент даже не смотрят. Так вот можно сделать ассистента который смотрит - что сейчас популярно и обсуждаемо, и расспрашивает автора об этом в его нише. В итоге генирируется контент план на неделю вперед.
